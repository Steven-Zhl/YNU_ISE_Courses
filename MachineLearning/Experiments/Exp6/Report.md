# 实验六：聚类和提示学习

> $author@Steven$

## 目录

* [实验六：聚类和提示学习](#实验六聚类和提示学习)
  * [目录](#目录)
  * [1. 聚类](#1-聚类)
    * [1.1 解题步骤](#11-解题步骤)
    * [1.2 结果分析](#12-结果分析)
  * [2. 循环神经网络](#2-循环神经网络)
    * [2.1 解题步骤](#21-解题步骤)
    * [2.2 结果分析](#22-结果分析)

## 1. 聚类

    本任务中你将自己实现k-means聚类算法，将数据完成聚类，针对数据选择合适的簇数，并且自己实现聚类算法过程，尝试不同的初始中心点，观察聚类结果，将结果可视化并分析。
    文件ex6data.csv包含我们的线性可分类问题的数据集。x，y代表纵横坐标。
  ![K-means](./IMG/K-means%20algorithm.jpg)

### 1.1 解题步骤

* 按照上述伪代码的算法步骤，迭代执行即可。

### 1.2 结果分析

![K-means result](./IMG/K-means%20result.png "最终聚类结果")
![K-means iteration](./IMG/K-means%20iteration.png "迭代次数及均值向量的变化")

* 最终结果还是不错的

## 2. 循环神经网络

    本任务中你讲尝试使用提示学习完成文本情感分析。
    提示学习通过构造提示，引导预训练语言模型完成文本分析、生成等相关任务。以下是使用提示学习进行文本情感分析的一个例子。
  ![Prompt Engineering](./IMG/prompt%20engineering%20demo.png)

### 2.1 解题步骤

* 准备好提示词：`prefix = "对于下面这段话，请判断其情感是积极还是消极，直接给出判断结果，不要做出任何分析"`
* 循环调用下面两句获取预测结果：
  * `self.model = self.model.eval()`
  * `ans, _ = self.model.chat(self.tokenizer, f"{prefix}：“{comment}”", [])`
* 使用`try-except`捕获`KeyboardInterrupt`，当触发后将本次判断的结果存入csv中，并计算本次判断的准确度和总准确度。

### 2.2 结果分析

![ChatGLM分析结果](./IMG/ChatGLM%20result.png "ChatGLM分析结果")
![ChatGLM判断结果导出](./IMG/ChatGLM%20data.png "ChatGLM判断结果导出")

* 可以看出整体效果不错，在1000+条数据上的准确率为$89.5\%$。

* 多说一句，在检查了原始数据集之后发现，有些可能是数据集本身标注就有误或不太准确。
  * 例如对于其中一条数据`买了给老爸看，好好保健，身体重要`，这句评论个人认为更偏积极，ChatGLM也做出了积极的判断，但标记的`label`为0。所以实际上ChatGLM的能力应该比上述结果更强。
